#!/usr/bin/env bash

{{- $fishExists := lookPath "fish" }}
{{- if not $fishExists }}
# Fish not found - skip setup
exit 0
{{- else }}

set -euo pipefail

FISH_PATH="/opt/homebrew/bin/fish"

# Ensure fish is in /etc/shells
if ! grep -qx "$FISH_PATH" /etc/shells; then
  echo "$FISH_PATH" | sudo tee -a /etc/shells > /dev/null
fi

# Set fish as default shell if not already
if [ "$SHELL" != "$FISH_PATH" ]; then
  chsh -s "$FISH_PATH"
fi
{{- end }}
