#!/usr/bin/env bash

# machine_type: {{ .machine.type }}
# brewfile_sha256: {{ include "Brewfile.tmpl" | sha256sum }}


set -euo pipefail

# Add Homebrew to PATH
eval "$(/opt/homebrew/bin/brew shellenv)"

# Generate Brewfile from template
chezmoi execute-template < "{{ .chezmoi.sourceDir }}/Brewfile.tmpl" > "{{ .chezmoi.sourceDir }}/Brewfile"

# Install all packages from Brewfile
brew bundle --quiet --file="{{ .chezmoi.sourceDir }}/Brewfile"

# Run mise install to set up runtime versions
mise install
