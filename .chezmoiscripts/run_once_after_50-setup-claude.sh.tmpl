#!/usr/bin/env bash

# Setup Claude Code

{{- $claudeExists := lookPath "claude" }}
{{- if not $claudeExists }}
# Claude Code not found - skip setup
exit 0
{{- else }}
{{- $mcpList := output "claude" "mcp" "list" | default "" }}
{{- if contains "context7" $mcpList }}
# Context7 MCP already configured - skip setup
exit 0
{{- else }}

# Add Context7 MCP server at user scope
claude mcp add --scope user --transport http context7 https://mcp.context7.com/mcp \
  --header "CONTEXT7_API_KEY: {{ onepasswordRead "op://Personal/Context7/claude code" }}"

# Start Serena MCP server for IDE Assistant project
claude mcp add serena -- serena start-mcp-server --context ide-assistant --project "$(pwd)"
{{- end }}
{{- end }}
