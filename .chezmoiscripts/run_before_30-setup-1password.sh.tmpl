#!/usr/bin/env bash

set -euo pipefail

# Add Homebrew to PATH
eval "$(/opt/homebrew/bin/brew shellenv)"

# Check if op CLI is available
if ! command -v op &> /dev/null; then
  echo "❌ 1Password CLI not found"
  echo ""
  echo "Action needed:"
  echo "  This should have been installed by setup-packages script"
  exit 1
fi

# Check if any accounts are configured
if ! op account list 2>/dev/null | grep -q "@"; then
  echo "❌ No 1Password accounts configured"
  echo ""
  echo "Action needed:"
  echo "  1. Open 1Password GUI"
  echo "  2. Go to Settings > Developer"
  echo "  3. Enable 'Integrate with 1Password CLI'"
  echo ""
  exit 1
fi